{"version":3,"sources":["webpack:///webpack/bootstrap c1e63bc3ebaeead340b2","webpack:///./src/server/app.js","webpack:///external \"express\"","webpack:///external \"path\"","webpack:///external \"serve-favicon\"","webpack:///external \"morgan\"","webpack:///external \"cookie-parser\"","webpack:///external \"body-parser\"","webpack:///external \"express-handlebars\"","webpack:///external \"mongoose\"","webpack:///external \"passport\"","webpack:///external \"express-session\"","webpack:///external \"connect-flash\"","webpack:///external \"react\"","webpack:///external \"react-dom/server\"","webpack:///./src/server/routes/index.js","webpack:///./src/server/routes/users.js","webpack:///external \"formidable\"","webpack:///./src/server/models/user.model.js","webpack:///external \"bcrypt-nodejs\"","webpack:///./src/server/passport.js","webpack:///external \"passport-local\""],"names":["app","use","urlencoded","extended","connect","require","engine","defaultLayout","extname","set","normalize","__dirname","secret","resave","saveUninitialized","initialize","session","static","req","res","next","err","Error","status","get","render","message","error","listen","console","log","router","Router","urlParser","send","isLoggedIn","messages","flash","errors","hasErrors","length","post","form","parse","files","username","password","authenticate","user","info","Object","keys","logIn","json","success","failureRedirect","failureFlash","redirect","isAuthenticated","UserSchema","Schema","type","String","required","methods","validPassword","canidatePassword","compareSync","pre","hashSync","genSaltSync","User","model","serializeUser","done","id","deserializeUser","findById","passReqToCallback","u","p","findOne","newUser","save","theNewUser"],"mappings":"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","file":"app.js","sourcesContent":[" \t// The module cache\n \tvar installedModules = {};\n\n \t// The require function\n \tfunction __webpack_require__(moduleId) {\n\n \t\t// Check if module is in cache\n \t\tif(installedModules[moduleId])\n \t\t\treturn installedModules[moduleId].exports;\n\n \t\t// Create a new module (and put it into the cache)\n \t\tvar module = installedModules[moduleId] = {\n \t\t\texports: {},\n \t\t\tid: moduleId,\n \t\t\tloaded: false\n \t\t};\n\n \t\t// Execute the module function\n \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n \t\t// Flag the module as loaded\n \t\tmodule.loaded = true;\n\n \t\t// Return the exports of the module\n \t\treturn module.exports;\n \t}\n\n\n \t// expose the modules object (__webpack_modules__)\n \t__webpack_require__.m = modules;\n\n \t// expose the module cache\n \t__webpack_require__.c = installedModules;\n\n \t// __webpack_public_path__\n \t__webpack_require__.p = \"\";\n\n \t// Load entry module and return exports\n \treturn __webpack_require__(0);\n\n\n\n// WEBPACK FOOTER //\n// webpack/bootstrap c1e63bc3ebaeead340b2","import express from \"express\"\r\nimport path from \"path\"\r\nimport favicon from \"serve-favicon\"\r\nimport logger from \"morgan\";\r\nimport cookieParser from \"cookie-parser\"\r\nimport bodyParser from \"body-parser\"\r\nimport hbs from \"express-handlebars\"\r\nimport mongoose from \"mongoose\"\r\nimport passport from \"passport\"\r\nimport session from \"express-session\"\r\nimport flash from \"connect-flash\"\r\nimport React from \"react\"\r\nimport ReactDOMServer from \"react-dom/server\";\r\n\r\nimport routes from \"./routes/index\"\r\nimport users from \"./routes/users\"\r\n\r\n\r\nconst app = express();\r\n\r\n\r\napp.use(bodyParser.urlencoded({ extended: true }));\r\n\r\nmongoose.connect(\"localhost/ChattyDB\");\r\n\r\nrequire(\"./passport\")\r\n\r\n// view engine setup\r\napp.engine(\"hbs\", hbs({defaultLayout: \"layout\", extname: \".hbs\"}));\r\napp.set('views', path.normalize(__dirname + `/../../views`));\r\napp.set('view engine', 'hbs');\r\n\r\n// uncomment after placing your favicon in /public\r\n//app.use(favicon(path.join(__dirname, 'public', 'favicon.ico')));\r\napp.use(logger('dev'));\r\napp.use(cookieParser());\r\n\r\napp.use(session({\r\n  secret: \"mysuperawesomesecretthatnoonecanbreak\",\r\n  resave: false,\r\n  saveUninitialized: false\r\n}));\r\napp.use(flash());\r\n\r\napp.use(passport.initialize());\r\napp.use(passport.session());\r\n\r\napp.use(express.static(path.normalize(`./${__dirname}/../../public`)));\r\n\r\napp.use('/', routes);\r\napp.use('/user', users);\r\n\r\n// catch 404 and forward to error handler\r\napp.use((req, res, next) => {\r\n  var err = new Error('Not Found');\r\n  err.status = 404;\r\n  next(err);\r\n});\r\n\r\n// error handlers\r\n\r\n// development error handler\r\n// will print stacktrace\r\nif (app.get('env') === 'development') {\r\n  app.use((err, req, res, next) => {\r\n    res.status(err.status || 500);\r\n    res.render('error', {\r\n      message: err.message,\r\n      error: err\r\n    });\r\n  });\r\n}\r\n\r\n// production error handler\r\n// no stacktraces leaked to user\r\napp.use((err, req, res, next) => {\r\n  res.status(err.status || 500);\r\n  res.render('error', {\r\n    message: err.message,\r\n    error: {}\r\n  });\r\n});\r\n\r\n\r\napp.listen(3000, () => {\r\n  console.log(\"Server listening in port 3000\")\r\n})\r\n\n\n\n// WEBPACK FOOTER //\n// ./src/server/app.js","module.exports = require(\"express\");\n\n\n//////////////////\n// WEBPACK FOOTER\n// external \"express\"\n// module id = 1\n// module chunks = 0","module.exports = require(\"path\");\n\n\n//////////////////\n// WEBPACK FOOTER\n// external \"path\"\n// module id = 2\n// module chunks = 0","module.exports = require(\"serve-favicon\");\n\n\n//////////////////\n// WEBPACK FOOTER\n// external \"serve-favicon\"\n// module id = 3\n// module chunks = 0","module.exports = require(\"morgan\");\n\n\n//////////////////\n// WEBPACK FOOTER\n// external \"morgan\"\n// module id = 4\n// module chunks = 0","module.exports = require(\"cookie-parser\");\n\n\n//////////////////\n// WEBPACK FOOTER\n// external \"cookie-parser\"\n// module id = 5\n// module chunks = 0","module.exports = require(\"body-parser\");\n\n\n//////////////////\n// WEBPACK FOOTER\n// external \"body-parser\"\n// module id = 6\n// module chunks = 0","module.exports = require(\"express-handlebars\");\n\n\n//////////////////\n// WEBPACK FOOTER\n// external \"express-handlebars\"\n// module id = 7\n// module chunks = 0","module.exports = require(\"mongoose\");\n\n\n//////////////////\n// WEBPACK FOOTER\n// external \"mongoose\"\n// module id = 8\n// module chunks = 0","module.exports = require(\"passport\");\n\n\n//////////////////\n// WEBPACK FOOTER\n// external \"passport\"\n// module id = 9\n// module chunks = 0","module.exports = require(\"express-session\");\n\n\n//////////////////\n// WEBPACK FOOTER\n// external \"express-session\"\n// module id = 10\n// module chunks = 0","module.exports = require(\"connect-flash\");\n\n\n//////////////////\n// WEBPACK FOOTER\n// external \"connect-flash\"\n// module id = 11\n// module chunks = 0","module.exports = require(\"react\");\n\n\n//////////////////\n// WEBPACK FOOTER\n// external \"react\"\n// module id = 12\n// module chunks = 0","module.exports = require(\"react-dom/server\");\n\n\n//////////////////\n// WEBPACK FOOTER\n// external \"react-dom/server\"\n// module id = 13\n// module chunks = 0","import express from \"express\"\r\nconst router = express.Router();\r\n\r\n/* GET home page. */\r\n// router.get('/', (req, res, next) => {\r\n//   res.render('index', { title: 'Express' });\r\n// });\r\n\r\nrouter.get(\"/*\", (req, res) => {\r\n  res.render(\"react-view\")\r\n})\r\n\r\nexport default router\r\n\n\n\n// WEBPACK FOOTER //\n// ./src/server/routes/index.js","import express from \"express\"\r\nimport passport from \"passport\"\r\nimport bodyParser from \"body-parser\"\r\nimport { IncomingForm } from \"formidable\"\r\n\r\nconst router = express.Router();\r\n\r\nimport User from \"../models/user.model\"\r\n\r\nvar urlParser = bodyParser.urlencoded({ extended: false })\r\n\r\n/* GET users listing. */\r\nrouter.get('/', (req, res, next) => {\r\n  res.send('respond with a resource');\r\n});\r\n\r\nrouter.get('/profile', isLoggedIn, (req, res) => {\r\n  res.render('profile');\r\n})\r\n\r\nrouter.get('/signin', (req, res) => {\r\n  var messages = req.flash(\"error\");\r\n  res.render('signin', { errors: messages, hasErrors: messages.length > 0 });\r\n});\r\n\r\nrouter.post('/signin', urlParser, function (req, res, next) {\r\n  var form = new IncomingForm()\r\n\r\n  form.parse(req, (err, { username, password }, files) => {\r\n    console.log(username, password)\r\n  })\r\n  passport.authenticate(\"signin\", (err, user, info) => {\r\n    if (err) {\r\n      return next(err)\r\n    }\r\n\r\n    console.log(`${err} ${user} ${Object.keys(info)}`)\r\n\r\n    // if (!user) {\r\n    //   return res.json({ success: false, error: info.message })\r\n    // }\r\n\r\n    req.logIn(user, error => {\r\n      if (error) {\r\n        return next(error)\r\n      }\r\n\r\n      req.user = user\r\n\r\n      return res.json({ success: true, error: null })\r\n    })\r\n  })(req, res, next)\r\n});\r\n\r\nrouter.get('/signup', (req, res) => {\r\n  var messages = req.flash(\"error\");\r\n  res.render('signup', { errors: messages, hasErrors: messages.length > 0 });\r\n});\r\n\r\nrouter.post('/signup', passport.authenticate('signup', {\r\n  failureRedirect: \"/user/signup\",\r\n  failureFlash: true\r\n}), (req, res) => {\r\n  res.redirect(\"/user/profile\");\r\n});\r\n\r\nrouter.post(\"/tester\", function(req, res) {\r\n  var form = new IncomingForm()\r\n  form.parse(req, (err, { username, password }, files) => {\r\n    console.log(`Username: ${username}\r\n    Password: ${password}\r\n    `)\r\n  })\r\n})\r\n\r\nfunction isLoggedIn(req, res, next) {\r\n  if (req.isAuthenticated()) {\r\n    return next();\r\n  } else {\r\n    res.redirect(\"/user/signin\");\r\n  }\r\n}\r\n\r\nexport default router\r\n\n\n\n// WEBPACK FOOTER //\n// ./src/server/routes/users.js","module.exports = require(\"formidable\");\n\n\n//////////////////\n// WEBPACK FOOTER\n// external \"formidable\"\n// module id = 16\n// module chunks = 0","import mongoose from \"mongoose\"\r\nimport bcrypt from \"bcrypt-nodejs\"\r\n\r\nvar UserSchema = new mongoose.Schema({\r\n    username: {type: String, required: true},\r\n    password: {type: String, required: true}\r\n});\r\n\r\nUserSchema.methods.validPassword = function(canidatePassword) {\r\n    return bcrypt.compareSync(canidatePassword, this.password);\r\n}\r\n\r\nUserSchema.pre(\"save\", function(next) {\r\n    this.password = bcrypt.hashSync(this.password, bcrypt.genSaltSync(10), null);\r\n    next();\r\n})\r\n\r\nvar User = mongoose.model(\"User\", UserSchema);\r\n\r\nexport default User\n\n\n// WEBPACK FOOTER //\n// ./src/server/models/user.model.js","module.exports = require(\"bcrypt-nodejs\");\n\n\n//////////////////\n// WEBPACK FOOTER\n// external \"bcrypt-nodejs\"\n// module id = 18\n// module chunks = 0","import passport from \"passport\"\r\nimport LocatStratagy from \"passport-local\"\r\nimport User from \"./models/user.model\"\r\nimport { IncomingForm } from \"formidable\"\r\n\r\npassport.serializeUser((user, done) => {\r\n    done(null, user.id);\r\n});\r\n\r\npassport.deserializeUser((id, done) => {\r\n    User.findById(id, function (err, user) {\r\n        done(err, user);\r\n    });\r\n});\r\n\r\npassport.use(\"signup\", new LocatStratagy({\r\n    passReqToCallback: true\r\n}, (req, u, p, done) => {\r\n    var form = new IncomingForm()\r\n\r\n    form.parse(req, (err, { username, password }, files) => {\r\n\r\n        User.findOne({ username }, (err, user) => {\r\n            if (err) {\r\n                return done(err);\r\n            }\r\n\r\n            if (user) {\r\n                return done(null, false, { message: \"Username is already taken\" });\r\n            }\r\n\r\n            var newUser = new User({\r\n                username,\r\n                password\r\n            });\r\n\r\n            newUser.save((err, theNewUser) => {\r\n                if (err) {\r\n                    return done(err);\r\n                }\r\n\r\n                return done(null, theNewUser);\r\n            });\r\n        });\r\n    })\r\n\r\n}));\r\n\r\npassport.use(\"signin\", new LocatStratagy({\r\n    passReqToCallback: true\r\n}, (req, u, p, done) => {\r\n\r\n    var form = new IncomingForm()\r\n\r\n    console.log(\"HELP!!!!\")\r\n\r\n    form.parse(req, (err, { username, password }, files) => {\r\n\r\n        User.findOne({ username }, function (err, user) {\r\n            if (err) {\r\n                return done(err);\r\n            }\r\n\r\n            if (!user) {\r\n                return done(null, false, { message: \"Username not found\" });\r\n            }\r\n\r\n            if (!user.validPassword(password)) {\r\n                return done(null, false, { message: \"Invalid Password\" })\r\n            }\r\n\r\n            return done(null, user)\r\n        });\r\n    })\r\n}));\r\n\n\n\n// WEBPACK FOOTER //\n// ./src/server/passport.js","module.exports = require(\"passport-local\");\n\n\n//////////////////\n// WEBPACK FOOTER\n// external \"passport-local\"\n// module id = 20\n// module chunks = 0"],"sourceRoot":""}